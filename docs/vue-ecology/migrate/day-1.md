# day1-新搭建项目模板

思考之后，只有两个方向来进行迁移：

1. 完全重写代码
2. 升级原有代码，渐进式迁移

在参考了涉及的antdv、vue3、pinia、vue-cli to vite的升级文档之后，决定根据第一种方案来做迁移升级。

主要有以下原因：

- 由于项目使用的是antdv-1.7版本的，而且因为是后台项目，项目中大量使用Form组件，但是在antdv-2.0版本对Form组件进行了重构，不再支持v-decorator。
  这也就意味着所有使用Form组件的地方都必须重新改造。这无异于重写代码
- 目前业务不太忙而且项目整体复杂度不高

虽然说成本很高，但是重写代码+代码格式强制校验可以避免在迁移过程中遇到莫名奇怪的问题，而且也可以摒弃原有代码设计的不合理的地方。

但是如果业务很忙而且项目很复杂，那么建议根据第二种方案进行，否则重写代码将会非常折磨。

## 项目模板

在开始迁移时，我们需要准备好一个基于vite的项目模板，由于在之前另外一个项目使用了Vue3+vite来开发的，于是便拿过来直接进行改造：

- plugins模块化管理
    - 引入了自动导入组件插件`unplugin-vue-components`，但是没有引入自动导入Vue API的插件，原因是：由于项目没有使用TS，在自动导入之后会丢失IDE的智能提示
    - 引入了svg组件插件`vite-svg-loader`，将svg导入之后，可以直接当作组件使用
- 对于全局样式，能通过修改主题的方式改变就尽量不添加全局改变样式。比如button组件可能会有多种状态，不同的状态展示不同样式，全局修改样式可能会有些状态考虑不到。
- 引入了pinia管理全局状态，pinia提供了很好的智能提示，而且搭配hook使用非常方便。
- 代码风格校验这块使用eslint+prettier+stylelint，让专业的人干专业的事
- 重新封装axios，让开发者只需要关注响应成功的情况，请求错误和错误信息展示在拦截器阶段统一处理。
- api、路由导出通过枚举形式，使用时更加灵活

## 项目迁移

在完成项目模板搭建之后，又完成了登录页面以及从服务端加载路由的逻辑。
